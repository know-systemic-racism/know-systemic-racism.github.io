<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Chloe Williams">
<meta name="dcterms.date" content="2023-08-18">

<title>know-systemic-racism - Wikidata Notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">know-systemic-racism</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./workplan_summer_2023.html" rel="" target="">
 <span class="menu-text">Workplan</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./data_prep.html" rel="" target="">
 <span class="menu-text">Data</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./wikidata_notes.qmd" rel="" target="">
 <span class="menu-text">Wikidata Schemas</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#record-type-1" id="toc-record-type-1" class="nav-link active" data-scroll-target="#record-type-1">Record type # 1</a>
  <ul class="collapse">
  <li><a href="#notes" id="toc-notes" class="nav-link" data-scroll-target="#notes">Notes:</a></li>
  </ul></li>
  <li><a href="#record-type-2" id="toc-record-type-2" class="nav-link" data-scroll-target="#record-type-2">Record type # 2</a>
  <ul class="collapse">
  <li><a href="#notes-1" id="toc-notes-1" class="nav-link" data-scroll-target="#notes-1">Notes:</a></li>
  </ul></li>
  <li><a href="#record-type-3" id="toc-record-type-3" class="nav-link" data-scroll-target="#record-type-3">Record type # 3</a>
  <ul class="collapse">
  <li><a href="#notes-2" id="toc-notes-2" class="nav-link" data-scroll-target="#notes-2">Notes:</a></li>
  </ul></li>
  <li><a href="#sources" id="toc-sources" class="nav-link" data-scroll-target="#sources">Sources</a></li>
  <li><a href="#open-refine-to-wikidata-schema" id="toc-open-refine-to-wikidata-schema" class="nav-link" data-scroll-target="#open-refine-to-wikidata-schema">Open Refine to Wikidata Schema</a></li>
  <li><a href="#wikidata-links" id="toc-wikidata-links" class="nav-link" data-scroll-target="#wikidata-links">Wikidata links</a></li>
  <li><a href="#wikidata-queries" id="toc-wikidata-queries" class="nav-link" data-scroll-target="#wikidata-queries">Wikidata Queries</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Wikidata Notes</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Chloe Williams </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 18, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>There are three types of records within Wikidata that I imported within the past six weeks.</p>
<section id="record-type-1" class="level1">
<h1>Record type # 1</h1>
<p>Victim records: Using the CA Fatal Encounters spreadsheet from Github, I worked specifically with fields that were filtered for “Race Imputation = African American” which was 819 records. These records contain basic information about the victim and include the following fields:</p>
<table class="table">
<colgroup>
<col style="width: 26%">
<col style="width: 21%">
<col style="width: 18%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Wikidata Property</th>
<th>Wikidata Value</th>
<th>Usage Note</th>
<th>Field used from Sprdsht</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>instance of (P31)</td>
<td>human (Q5)</td>
<td></td>
<td>n/a</td>
</tr>
<tr class="even">
<td>sex or gender (P21)</td>
<td>female (Q6581072), male (Q6581097), trans man (Q2449503), trans woman (Q1052281)</td>
<td></td>
<td>Gender</td>
</tr>
<tr class="odd">
<td>country of citizenship (P27)</td>
<td>United States of America (Q30)</td>
<td></td>
<td>n/a</td>
</tr>
<tr class="even">
<td>given name (P735)</td>
<td>Victim’s first name</td>
<td></td>
<td>First name</td>
</tr>
<tr class="odd">
<td>family name (P734)</td>
<td>Victim’s last name</td>
<td></td>
<td>Last name</td>
</tr>
<tr class="even">
<td>date of death (P570)</td>
<td>YYYY-MM-DD</td>
<td>The date the victim died</td>
<td>Date of death (YYYY-MM-DD)</td>
</tr>
<tr class="odd">
<td>place of death (P20)</td>
<td>city (Q515) street address (P6375)</td>
<td>City where the victim died Physical address of significant event (if available)</td>
<td>City Full address</td>
</tr>
<tr class="even">
<td>manner of death (P1196)</td>
<td>homicide (Q149086)</td>
<td>Each incident is defined as a homicide based on information from https://fatalencounters.org/</td>
<td>n/a</td>
</tr>
<tr class="odd">
<td>cause of death (P509)</td>
<td>ballistic trauma (Q2140674), fall (Q11620540), car collision (Q61037771), strike (Q3242199), drowning (Q506616), asphyxia (Q193840), electrical injury (Q244404), drug overdose (Q3505252), medical emergency (Q2751242), undetermined (Q15054664)</td>
<td>The highest level of force used by California Law Enforcement Agencies</td>
<td>Manner of death</td>
</tr>
<tr class="even">
<td>ethnic group (P172)</td>
<td>African Americans (Q49085)</td>
<td>At this time we are currently working with one group of victims; as more groups are added, values will be updated</td>
<td>Race with imputations</td>
</tr>
<tr class="odd">
<td>significant event (P793)</td>
<td>Death of [victim’s name] age of subject at event (P3629) participant (P710)=law enforcement agency (Q732717)</td>
<td>Wikidata page that lead to corresponding incident of person’s death Age of the person at the time of significant event The California Law Enforcement Agency that participated in the death of the victim</td>
<td>Significant event name Age Lea Lea 2 Lea 3</td>
</tr>
<tr class="even">
<td>described at URL (P973)</td>
<td>https://fatalencounters.org/ language of work or name (P407) = English (Q1860) retrieved (P813) YYYY-MM-DD</td>
<td>For summer 2023 project - 7/10/23 was used at retrieved date</td>
<td>n/a</td>
</tr>
<tr class="odd">
<td>on focus list of Wikimedia project (P5008)</td>
<td>Wikidata: WikiProject Systemic Racism Knowledge Graph (Q120754096)</td>
<td>Wikidata Project that ties California Law Enforcement Agencies, Victims, and Significant Events together</td>
<td>n/a</td>
</tr>
</tbody>
</table>
<section id="notes" class="level2">
<h2 class="anchored" data-anchor-id="notes">Notes:</h2>
<ul>
<li>date of death had to be formatted to YYYY-MM-DD which was done through OpenRefine – edit cells – common transformations – to date</li>
<li>Manner of death listed as “Vehicle” – Wikidata did not like this field and advised it did not make sense with the data we were importing. Any records listed as “Vehicle” were changed to “Car Collision”</li>
<li>Full names of victims (full name field) had to be separated into multiple columns for first, middle, last names, and nicknames. The names were split by through OpenRefine – edit column – split into several columns. The decision was made so a sort (if necessary) could be run against records in wikidata by first or last name.</li>
<li>The full name column is now formatted as Firstname M.I. LastName. Nicknames and aliases were removed. This is the label for the victim records. Ex.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/wikidata_images/Picture1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure 1</figcaption>
</figure>
</div>
<ul>
<li>There is only one property within wikidata victim records that is flagged. Date of Death. When using this property, wikidata would like to see a Date of Birth property. We did not have that information.<br>
<img src="images/wikidata_images/Picture2.png" class="img-fluid" alt="Figure 2"></li>
<li>Significant event property: this property contains three different statements and this had to be done to remove constraint violations within wikidata.<br>
<img src="images/wikidata_images/Picture3.png" class="img-fluid" alt="Figure 3"></li>
<li>Place of death property: this contains a qualifier that lists the full street address of where the victim died. Not all records have a full address, if no address is provided, this will pull closest streets, city, or county.<br>
<img src="images/wikidata_images/Picture4.png" class="img-fluid" alt="Figure 4"></li>
<li>Law enforcement agency is the “Participant” property within wikidata. There are three separate fields on the spreadsheet and schemas because there are a several records where multiple law enforcement agencies were involved.<br>
<img src="images/wikidata_images/Picture5.png" class="img-fluid" alt="Figure 5"></li>
</ul>
</section>
</section>
<section id="record-type-2" class="level1">
<h1>Record type # 2</h1>
<p>Significant Event records: Using the CA Fatal Encounters spreadsheet from Github, I worked specifically with fields that were filtered for “Race Imputation = African American” which was 819 records. These records contain basic death information about the victim and participating law enforcement agency and include the following fields:</p>
<table class="table">
<colgroup>
<col style="width: 26%">
<col style="width: 21%">
<col style="width: 18%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Wikidata Property</th>
<th>Wikidata Value</th>
<th>Usage Note</th>
<th>Field used from Sprdsht</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>instance of (P31)</td>
<td>homicide (Q149086) ballistic trauma (Q2140674), fall (Q11620540), car collision (Q61037771), strike (Q3242199), drowning (Q506616), asphyxia (Q193840), electrical injury (Q244404), drug overdose (Q3505252), medical emergency (Q2751242), undetermined (Q15054664)</td>
<td>Each incident is defined as a homicide based on information from https://fatalencounters.org The highest level of force used by California Law Enforcement Agencies</td>
<td>n/a Manner of death</td>
</tr>
<tr class="even">
<td>coordinate location (P625)</td>
<td>city (Q515), county (Q28575), census-designated place in the United States (Q498162), street address (Q24574749)</td>
<td>GPS location where the victim died</td>
<td>Lat_lon</td>
</tr>
<tr class="odd">
<td>point in time (P585)</td>
<td>date of death (P570) place of death (P20) street address (P6375) participant (P710) [name of victim]</td>
<td>The date of the incident where the victim died City where the victim died Physical street address where the victim died The California Law Enforcement Agency that participated in the death of the victim. * There can be multiple agencies that are involved This will be the Wikidata page of the victim e.g.&nbsp;https://www.wikidata.org/wiki/Q121140148</td>
<td>Date of death (YYYY-MM-DD) City Full address Lea Lea 2 Lea 3 Full name</td>
</tr>
<tr class="even">
<td>on focus list of Wikimedia project (P5008)</td>
<td>Wikidata: WikiProject Systemic Racism Knowledge Graph (Q120754096)</td>
<td>Wikidata Project that ties California Law Enforcement Agencies, Victims, and Significant Events together</td>
<td></td>
</tr>
</tbody>
</table>
<section id="notes-1" class="level2">
<h2 class="anchored" data-anchor-id="notes-1">Notes:</h2>
<ul>
<li>To eliminate constraint violations within wikidata – a point in time property had to be used. The point in time property includes date of death, place of death, full address of death (if available), participant (law enforcement agency), participant (victim)<br>
<img src="images/wikidata_images/Picture6.png" class="img-fluid" alt="Figure 6"></li>
<li>Coordinate location property: if there is no full address available, the location is pointing to the city where the victim died.</li>
<li>Instance of property: 125 records were changed from “Vehicle” to “Car Collision” as cause of death.</li>
<li>Significant event label – uses the significant event name field – this is used to search for the record.<br>
<img src="images/wikidata_images/Picture7.png" class="img-fluid" alt="Figure 7"></li>
</ul>
</section>
</section>
<section id="record-type-3" class="level1">
<h1>Record type # 3</h1>
<p>CA law enforcement agency records: Using the CA LEAspreadsheet from Github, I worked will all records on within the file. These records contain basic information about the participating law enforcement agency and include the following fields:</p>
<table class="table">
<colgroup>
<col style="width: 25%">
<col style="width: 21%">
<col style="width: 16%">
<col style="width: 36%">
</colgroup>
<thead>
<tr class="header">
<th>Wikidata Property</th>
<th>Wikidata Value</th>
<th>Usage Note</th>
<th>Field used from Spreadsheet</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>instance of (P31)</td>
<td>law enforcement agency (Q732717)</td>
<td></td>
<td>n/a</td>
</tr>
<tr class="even">
<td>country (P17)</td>
<td>United States of America (Q30)</td>
<td></td>
<td>n/a</td>
</tr>
<tr class="odd">
<td>located in the administrative territorial entity (P131)</td>
<td>county of California (Q13212489)</td>
<td>County of stated law enforcement agency e.g.&nbsp;Alpine County</td>
<td>County</td>
</tr>
<tr class="even">
<td>coordinate location (P625)</td>
<td>geographic coordinate (Q104224919)</td>
<td></td>
<td>Latlon</td>
</tr>
<tr class="odd">
<td>headquarters location (P159)</td>
<td>city in the United States (Q1093829), census-designated place in the United States (Q498162)</td>
<td>City or designated place of stated law enforcement agency e.g.&nbsp;Markleeville</td>
<td>City</td>
</tr>
<tr class="even">
<td>official website (P856)</td>
<td>URL (Q42253) archive URL (P1065) language of work or name (P407) = English (Q1860)</td>
<td>URL to stated law enforcement agency official website e.g.&nbsp;https://www.cityofchowchilla.org/176/Police-Department archived URL for law enforcement agencies official website e.g.&nbsp;https://web.archive.org/web/19981202190615/http://www.lapdonline.org/</td>
<td>Site url Webarchive site url</td>
</tr>
<tr class="odd">
<td>on focus list of Wikimedia project (P5008)</td>
<td>Wikidata: WikiProject Systemic Racism Knowledge Graph (Q120754096)</td>
<td>Wikidata Project that ties California Law Enforcement Agencies, Victims, and Significant Events together</td>
<td></td>
</tr>
<tr class="even">
<td>documentation files at (P10527)</td>
<td>Policy Manuals (Q121352506) described at URL (P973) retrieved (P813)</td>
<td>URL to stated law enforcement agency policy manual date policy was pulled from data source (format YYYY-MM-DD)</td>
<td>Policy manual 2023-07-10</td>
</tr>
</tbody>
</table>
<section id="notes-2" class="level2">
<h2 class="anchored" data-anchor-id="notes-2">Notes:</h2>
<ul>
<li>To eliminate constraint violations within wikidata for official website property. A separate archive url had to be used if an archived website was available. Also “Language of work or name property” needs to be used to prevent constraint violation.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/wikidata_images/Picture8.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure 8</figcaption>
</figure>
</div>
<ul>
<li>Coordination location points to the Headquarters location of the law enforcement agency.</li>
<li>There are law enforcement pages that have been created by other users – data from the schema above has been added to those records.</li>
</ul>
</section>
</section>
<section id="sources" class="level1">
<h1>Sources</h1>
<p>Burghart, D.B. (2020). Fatal Encounters: A step toward creating an impartial, comprehensive and searchable national database of people killed during interactions with police [data file and codebook]. <a href="https://fatalencounters.org/">https://fatalencounters.org/</a></p>
<p>Williams, C., Coleman, C., and Colmenares, A. (2023). California Law Enforcement Agencies. Stanford Digital Repository. Available at <a href="https://purl.stanford.edu/dj529nn1168">https://purl.stanford.edu/dj529nn1168</a>. <a href="https://doi.org/10.25740/dj529nn1168">https://doi.org/10.25740/dj529nn1168</a>.</p>
</section>
<section id="open-refine-to-wikidata-schema" class="level1">
<h1>Open Refine to Wikidata Schema</h1>
<p>Victim schema –</p>
<p>Incident schema –</p>
<p>Lea schema – Available on Github here: <a href="https://github.com/know-systemic-racism/ca-leas-data/">https://github.com/know-systemic-racism/ca-leas-data/</a></p>
</section>
<section id="wikidata-links" class="level1">
<h1>Wikidata links</h1>
<ul>
<li>WikiProject page:<a href="https://www.wikidata.org/wiki/Wikidata:WikiProject_Systemic_Racism_Knowledge_Graph">https://www.wikidata.org/wiki/Wikidata:WikiProject_Systemic_Racism_Knowledge_Graph</a></li>
<li>Law Enforcement schema: <a href="https://www.wikidata.org/wiki/Wikidata:WikiProject_Systemic_Racism_Knowledge_Graph/Law_Enforcement_Agency_Schema">https://www.wikidata.org/wiki/Wikidata:WikiProject_Systemic_Racism_Knowledge_Graph/Law_Enforcement_Agency_Schema</a></li>
<li>Victims schema: <a href="https://www.wikidata.org/wiki/Wikidata:WikiProject_Systemic_Racism_Knowledge_Graph/Victims_Schema">https://www.wikidata.org/wiki/Wikidata:WikiProject_Systemic_Racism_Knowledge_Graph/Victims_Schema</a></li>
<li>Incident schema: <a href="https://www.wikidata.org/wiki/Wikidata:WikiProject_Systemic_Racism_Knowledge_Graph/Significant_Incident_Schema">https://www.wikidata.org/wiki/Wikidata:WikiProject_Systemic_Racism_Knowledge_Graph/Significant_Incident_Schema</a></li>
</ul>
<p>Example pages:</p>
<ul>
<li>Example of victim wikidata page: <a href="https://www.wikidata.org/wiki/Q121168331">https://www.wikidata.org/wiki/Q121168331</a></li>
<li>Example of incident wikidata page: <a href="https://www.wikidata.org/wiki/Q121097141">https://www.wikidata.org/wiki/Q121097141</a></li>
<li>Example of law enforcement wikidata page: <a href="https://www.wikidata.org/wiki/Q120751316">https://www.wikidata.org/wiki/Q120751316</a></li>
</ul>
</section>
<section id="wikidata-queries" class="level1">
<h1>Wikidata Queries</h1>
<ul>
<li>All records associated with our wikidata project “Wikidata: WikiProject Systemic Racism Knowledge Graph”: <a href="https://w.wiki/7GmN">https://w.wiki/7GmN</a></li>
<li>All records associated with victims run the following query in wikidata: <a href="https://w.wiki/7GmH">https://w.wiki/7GmH</a></li>
<li>All records associated with significant events run the following query in wikidata: <a href="https://w.wiki/7GmQ">https://w.wiki/7GmQ</a></li>
<li>All records associated with LEAs run the following query in wikidata: <a href="https://w.wiki/7GmR">https://w.wiki/7GmR</a></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>